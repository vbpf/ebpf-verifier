# Copyright (c) Prevail Verifier contributors.
# SPDX-License-Identifier: MIT
---
test-case: simple valid access

pre: [
    "r1.type=packet", "r1.offset=0", "r1.value=[4098, 2147418112]",
    "r2.type=packet", "r2.offset=[0, 65534]", "r2.offset=packet_size"
]

code:
  <start>: |
    r3 = r1;
    r3 += 8;
    if r3 > r2 goto <out>
    r4 = 0
    *(u64 *)(r1 + 0) = r4
  <out>: |
    exit;

post: [
    "r1.type=packet", "r1.offset=0", "r1.value=[4098, 2147418112]",
    "r2.type=packet", "r2.offset=[0, 65534]", "r2.offset=packet_size",
    "r3.type=packet", "r3.offset=8", "r3.value=[4106, 2147418120]",
    "meta_offset=[-oo, 7]", "meta_offset-packet_size<=0", "meta_offset-r1.offset<=7", "meta_offset-r2.offset<=0", "meta_offset-r3.offset<=-1",
    "packet_size-r3.offset<=65526", "packet_size=[0, 65534]",
    "r0.type=number", "r1.offset-packet_size<=0", "r3.offset-packet_size<=8",
    "r1.offset-r2.offset<=0", "r1.offset-r3.offset<=65518",
    "r1.value=r3.value+8",
    "r2.type=r3.type", "r2.offset-r3.offset<=65526", "r3.offset-r2.offset<=8",
]
